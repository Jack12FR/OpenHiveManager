{# src/KG/BeekeepingManagementBundle/Resources/views/Ruche/view.html.twig #}

{% extends "KGBeekeepingManagementBundle::layout.html.twig" %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}

{% block title %}{{ parent() }} - Ruche{% endblock %}

{% block breadcrumbs %}
    {{ parent() }}
    <a href="{{ path('kg_beekeeping_management_view_exploitation_ruche', { 'exploitation_id': ruche.exploitation.id }) }}" class="btn btn-primary">{{ ruche.exploitation.nom }}</a>
    {% if ruche.emplacement %}{% if ruche.emplacement.rucher %}<a href="{{ path('kg_beekeeping_management_view_rucher', { 'rucher_id': ruche.emplacement.rucher.id }) }}" class="btn btn-primary">{{ ruche.emplacement.rucher.nom }}</a>{% endif %}{% endif %}
    <a href="{{ path('kg_beekeeping_management_view_ruche', { 'ruche_id': ruche.id }) }}" class="btn btn-primary">{{ ruche.nom }}</a>
{% endblock %} 

{% block screen %}  
    {% for flashMessage in app.session.flashbag.get('success') %}
        {% if loop.first %}
            <div class="alert alert-success" role="alert">
        {% endif %}
                <i><span class="glyphicon glyphicon-ok-sign"></span> {{ flashMessage }}</i>
        {% if loop.last %}        
            </div>
        {% endif %}
    {% endfor %}

    {% if not ruche.emplacement and ruche.colonnie %}
    <div class="alert alert-warning" role="alert">
        <center><i class="glyphicon glyphicon-alert"></i> Veuillez placer cette ruche dans un rucher pour créer des visites.</center>
    </div>
    {% endif %}
    
    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title">Ruche {{ ruche.nom }}</h3>
        </div>          
        <div class="panel-body">
            <div class="row">
                <div class="col-md-3 col-lg-3 " align="center"> 
                    {% if ruche.image is not null %}
                        <img src="{{ asset(ruche.image.webPath) }}" alt="{{ ruche.image.alt }}" class="img-thumbnail img-responsive">
                    {% else %}
                        <img src="../../../../../no_picture.png" alt="logo" class="img-thumbnail img-responsive">
                    {% endif %}           
                </div>
                <div class=" col-md-4 col-lg-4 ">
                    <h4>Descriptif</h4>
                    <table class="table">  
                        <tbody>
                            <tr>
                                <td><strong>Type :</strong></td>
                                <td>{{ ruche.type.libelle }}</td>
                            </tr>
                            <tr>
                                <td><strong>Matière :</strong></td>
                                <td>{{ ruche.matiere.libelle }}</td>
                            </tr>
                            <tr>
                                <td><strong>Nombre de cadres max:</strong></td>
                                <td>{{ ruche.cadres|length }}</td>
                            </tr>                            
                        </tbody>
                    </table>
                </div>            
                <div class=" col-md-5 col-lg-5 ">            
                        <h4>Colonnie 
                            {% if ruche.colonnie %}
                                <a title="Afficher la colonnie" href="{{ path('kg_beekeeping_management_view_colonnie', { 'colonnie_id': ruche.colonnie.id }) }}"> {{ ruche.colonnie.nom }}</a>
                            {% endif %}                                  
                        </h4>                          
                            {% if ruche.colonnie %}
                                <table class="table">
                                    <tbody>
                                        <tr>
                                            <td><strong>Race :</strong></td>
                                            <td>{{ ruche.colonnie.reine.race.libelle }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Affectation :</strong></td>
                                            <td>{{ ruche.colonnie.affectation.libelle }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Etat :</strong></td>
                                            <td>{{ ruche.colonnie.etat.libelle }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            {% else %}
                                Il n'y a pas de colonnie dans cette ruche.
                            {% endif %}                                      
                </div>
            </div> 

            {%if ruche.emplacement %}     
            <hr>
                
            <div class="row">    
                <div class=" col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">Cadres</h4>
                        </div>
                        <div class="panel-body">
                            {% for cadre in ruche.cadres %}
                                <div class="progress">
                                    <div class="progress-bar progress-bar-warning" style="width: {{ cadre.miel }}%">
                                        <span class="sr-only">{{ cadre.miel }}% Miel</span>
                                    </div>
                                    <div class="progress-bar progress-bar-danger" style="width: {{ cadre.couvain }}%">
                                        <span class="sr-only">{{ cadre.couvain }}% Couvain</span>
                                    </div>
                                    <div class="progress-bar progress-bar-info" style="width: {{ cadre.pollen }}%">
                                        <span class="sr-only">{{ cadre.pollen }}% Pollen</span>
                                    </div>
                                </div>                                         
                            {% endfor %}
                        </div> 
                    </div>    
                    <h5>Légende :</h5>
                    <div class="progress">
                        <div class="progress-bar progress-bar-warning" style="width: 33.33%">
                            Miel
                        </div>
                        <div class="progress-bar progress-bar-danger" style="width: 33.33%">
                            Couvain
                        </div>
                        <div class="progress-bar progress-bar-info" style="width: 33.33%">
                            Pollen
                        </div>
                    </div>   
                </div>
                <div class=" col-md-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">Hausses</h4>
                        </div>
                        <div class="panel-body">
                            {% for cadre in ruche.cadres %}
                                        
                            {% endfor %}
                        </div>
                    </div>
                </div>    
            </div> 
                
            <hr>
                
            <div class="row">    
                <div class=" col-md-12">         
                    <div class="table-responsive">
                        <table id="mytable" class="table table-bordred table-striped">
                            <thead>
                                <th>Visite</th>
                                <th>Afficher</th>
                            </thead>
                            <tbody>
                                {% for visite in visites %}
                                    <tr>
                                        <td></td>
                                        <td><a title="Afficher la visite" href="{{ path('kg_beekeeping_management_view_visite', { 'visite_id': visite.id }) }}" class="btn btn-xs btn-success"><span class="glyphicon glyphicon-eye-open"></span></a></td>                                        
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>                
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            {% include "KGBeekeepingManagementBundle::pagination.html.twig" %}
                        </div>
                    </div>                         
                </div>
            </div>  
            {% endif %}            
        </div>  
                
        <div class="panel-footer">
            <a title="Supprimer" href="{{ path('kg_beekeeping_management_delete_ruche', { 'ruche_id' : ruche.id }) }}" class="btn btn-sm btn-danger"><i class="glyphicon glyphicon-trash"></i></a>
            <span class="pull-right">
                {%if ruche.colonnie and ruche.emplacement %}<a title="Créer une visite" href="{{ path('kg_beekeeping_management_add_visite', { 'colonnie_id' : ruche.colonnie.id }) }}" class="btn btn-info btn-sm"><i class="glyphicon glyphicon-plus"></i></a>{% endif %}
                <a title="Editer" href="{{ path('kg_beekeeping_management_update_ruche', { 'ruche_id' : ruche.id }) }}" class="btn btn-sm btn-warning"><i class="glyphicon glyphicon-pencil"></i></a>
            </span>
        </div>                                                        
    </div>
{% endblock %}