<?php

namespace KG\BeekeepingManagementBundle\Entity;

use KG\UserBundle\Entity\User;
use Doctrine\ORM\EntityRepository;
use Doctrine\ORM\Tools\Pagination\Paginator;

/**
 * ApiculteurExploitationRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ApiculteurExploitationRepository extends EntityRepository
{
    public function getList(User $user, $page = 1, $maxperpage = 10)
    {
        $q = $this->_em->createQueryBuilder('ae')
             ->leftJoin('ae.exploitation', 'e')
             ->addSelect('e')
             ->where('ae.apiculteur = :user')
             ->setParameter('user', $user);
        
        $q->setFirstResult(($page-1)*$maxperpage)
          ->setMaxResults($maxperpage);
        
        return new Paginator($q);
    }
}
